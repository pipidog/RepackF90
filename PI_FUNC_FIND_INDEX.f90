! FIND INDEX ============================================================
! **** PURPOSE **** 
! THIS FUNCTION FIND ALL THE INDEX WITH LOGICAL "TRUE". THIS FUNCTION IS
! DESIGNED TO SIMULATES THE 'FIND' FUNCTION IN SCILAB.
! **** INPUT VARIABLES ****
! [M]: LOGICAL, (N), IF SHOULD BE GENERATED BY A LOGICAL DESCRIPTION 
! **** OUTPUT VARIABLES ****
! [M_INDEX]: INTEGER, COUNT(LOGICAL DESRIPION), THE INDEX WITH TRUE
! **** VERSION ****
! 1/26/2014 FIRST BUILT 
! 1/31/2014 ADD EXIT WHEN SEARCHING COMPLETE ERALIER
! **** COMMENT ****
! EXAMPLE: 	
! ALLOCATE(A_INDEX(COUNT(A>0)))
! CALL PI_FIND_VEC(A>0,SHAPE(A),A_INDEX,SHAPE(A_INDEX))

SUBROUTINE PI_FIND_VECT(V,V_DIM,V_INDEX,V_INDEX_DIM)
	IMPLICIT NONE
	! DIMENSION
	INTEGER, INTENT(IN) :: V_DIM, V_INDEX_DIM
	! INPUT
	LOGICAL, INTENT(IN) :: V(V_DIM)
	! OUTPUT
	INTEGER, INTENT(OUT) :: V_INDEX(V_INDEX_DIM) 
	! LOCAL(DUMMY)
	INTEGER :: N
	! LOCAL(VALUE)
	INTEGER :: TOT_COUNT
	! LOCAL(ARRAY)
	! LOCAL(ALLOCATABLE)
	! N/A
	! VARIABLE INITIALIZATION
	V_INDEX=0 ! OUTPUT
	TOT_COUNT=0 ! LOCAL(VALUE)
	IF (V_INDEX_DIM /= COUNT(V)) THEN
		WRITE(*,*) "ERROR IN PI_FIND_VECT! V_INDEX_DIM IS WRONG!"
		RETURN
	END IF
	! PROGRAM START
		DO N=1,V_DIM
			IF (V(N)) THEN
				TOT_COUNT=TOT_COUNT+1
				V_INDEX(TOT_COUNT)=N
				IF (TOT_COUNT==V_INDEX_DIM) THEN
					RETURN
				END IF
			END IF
		END DO
END SUBROUTINE

! **** INPUT VARIABLES ****
! [M]: LOGICAL, (NXM), IF SHOULD BE GENERATED BY A LOGICAL DESCRIPTION 
! **** OUTPUT VARIABLES ****
! [M_INDEX]: INTEGER, 2XCOUNT(LOGICAL DESRIPION), THE INDEX WITH TRUE

SUBROUTINE PI_FIND_MAT(M,M_DIM,M_INDEX,M_INDEX_DIM)
	IMPLICIT NONE
	! DIMENSION
	INTEGER, INTENT(IN) :: M_DIM(2), M_INDEX_DIM(2)
	! INPUT
	LOGICAL, INTENT(IN) :: M(M_DIM(1), M_DIM(2))
	! OUTPUT
	INTEGER, INTENT(OUT) :: M_INDEX(M_INDEX_DIM(1),M_INDEX_DIM(2)) 
	! LOCAL(DUMMY)
	INTEGER :: N, P
	! LOCAL(VALUE)
	INTEGER :: TOT_COUNT
	! LOCAL(ARRAY)
	! LOCAL(ALLOCATABLE)
	! N/A
	! VARIABLE INITIALIZATION
	M_INDEX=0 ! OUTPUT
	TOT_COUNT=0 ! LOCAL(VALUE)
	IF (M_INDEX_DIM(2) /= COUNT(M)) THEN
		WRITE(*,*) "ERROR IN PI_FIND_MAT! M_INDEX_DIM IS WRONG!"
		RETURN
	END IF
	! PROGRAM START
	DO P=1,M_DIM(2)
		DO N=1,M_DIM(1)
			IF (M(N,P)) THEN
				TOT_COUNT=TOT_COUNT+1
				M_INDEX(1,TOT_COUNT)=N
				M_INDEX(2,TOT_COUNT)=P
				IF (TOT_COUNT==M_INDEX_DIM(2)) THEN
					RETURN
				END IF
			END IF
		END DO
	END DO
END SUBROUTINE
	